# 桌面AI助手 - MVP任务列表

> 基于 README.md、功能实现讨论.md、元件.md 整理
> 创建日期: 2026-02-05
> 最小MVP方案：ESP32-S3 + INMP441 + MAX98357A + 喇叭 + 屏幕 + 电源管理

---

## 一、硬件准备与采购

### 1.1 元件采购清单

| 元件 | 型号 | 数量 | 用途 |
|------|------|------|------|
| 主控芯片 | ESP32-S3 | 1 | WiFi/蓝牙、双核处理 |
| 麦克风 | INMP441 (I2S) | 1 | 语音采集 |
| 功放芯片 | MAX98357A | 1 | I2S音频输出 |
| 扬声器 | 3W 4Ω喇叭 | 1 | 语音播放 |
| 显示屏 | 1.69" IPS TFT (ST7789) | 1 | 时间/天气显示 |
| 电源芯片 | AMS1117-3.3 | 1 | 3.3V稳压 |
| 充电芯片 | TP4056 | 1 | 锂电池充电 |
| 锂电池 | 3.7V 1000-2000mAh | 1 | 供电 |
| Type-C接口 | 16P母座 | 1 | 充电/调试 |
| 其他 | 杜邦线、面包板、电阻电容等 | 若干 | 连接调试 |

### 1.2 采购任务

- [ ] 采购 ESP32-S3 开发板
- [ ] 采购 INMP441 麦克风模块
- [ ] 采购 MAX98357A 功放模块
- [ ] 采购 3W 4Ω 扬声器
- [ ] 采购 1.69寸 ST7789 显示屏
- [ ] 采购电源管理元件（AMS1117、TP4056、锂电池、Type-C）
- [ ] 采购面包板、杜邦线等调试工具

---

## 二、硬件开发环境搭建

### 2.1 开发环境

- [ ] 安装 Arduino IDE 或 PlatformIO
- [ ] 安装 ESP32-S3 开发板支持包
- [ ] 安装必要的库（ESP32-audioI2S、TFT_eSPI等）
- [ ] 配置串口调试工具

### 2.2 硬件连接文档

- [ ] 绘制 ESP32-S3 引脚分配图
- [ ] 编写各模块接线说明文档

---

## 三、硬件模块调试（逐个验证）

### 3.1 ESP32-S3 基础测试

- [ ] 烧录测试程序，验证开发板正常工作
- [ ] 测试 WiFi 连接功能
- [ ] 测试串口通信

### 3.2 麦克风模块（INMP441）

- [ ] 连接 INMP441 到 ESP32-S3（I2S接口）
- [ ] 编写音频采集测试代码
- [ ] 验证麦克风能正常录音
- [ ] 测试录音质量和采样率

### 3.3 功放与扬声器（MAX98357A）

- [ ] 连接 MAX98357A 和扬声器到 ESP32-S3
- [ ] 编写音频播放测试代码
- [ ] 验证扬声器能正常播放音频
- [ ] 测试音量控制

### 3.4 显示屏（ST7789）

- [ ] 连接 ST7789 显示屏到 ESP32-S3（SPI接口）
- [ ] 配置 TFT_eSPI 库参数
- [ ] 编写显示测试代码
- [ ] 验证屏幕显示文字和图形

### 3.5 电源管理

- [ ] 搭建电源电路（TP4056 + AMS1117）
- [ ] 测试锂电池充电功能
- [ ] 测试 3.3V 稳压输出
- [ ] 验证整体供电稳定性

---

## 四、硬件功能整合

### 4.1 音频系统整合

- [ ] 实现麦克风录音 + 扬声器播放的完整流程
- [ ] 测试录音后立即播放（回声测试）
- [ ] 优化音频质量参数

### 4.2 显示系统整合

- [ ] 实现时间显示功能
- [ ] 实现基础UI界面框架
- [ ] 测试屏幕刷新率

### 4.3 整体硬件联调

- [ ] 所有模块同时工作测试
- [ ] 检查功耗和发热情况
- [ ] 优化引脚分配和布线

---

## 五、原理图与PCB设计

### 5.1 原理图设计

- [ ] 选择EDA工具（立创EDA / KiCad / Altium Designer）
- [ ] 创建/导入各元件符号库
  - [ ] ESP32-S3 模块符号
  - [ ] INMP441 麦克风符号
  - [ ] MAX98357A 功放符号
  - [ ] ST7789 显示屏接口符号
  - [ ] TP4056 充电芯片符号
  - [ ] AMS1117 稳压芯片符号
  - [ ] Type-C 接口符号
- [ ] 绘制主控电路（ESP32-S3 最小系统）
- [ ] 绘制音频输入电路（INMP441）
- [ ] 绘制音频输出电路（MAX98357A + 扬声器）
- [ ] 绘制显示屏接口电路（ST7789）
- [ ] 绘制电源管理电路（Type-C + TP4056 + AMS1117）
- [ ] 添加去耦电容、滤波电容
- [ ] 添加ESD保护电路（可选）
- [ ] 原理图审核（DRC检查）
- [ ] 生成BOM清单

### 5.2 PCB设计

- [ ] 确定PCB尺寸和外形
- [ ] 创建/导入各元件封装库
  - [ ] ESP32-S3 模块封装
  - [ ] INMP441 封装
  - [ ] MAX98357A 封装
  - [ ] ST7789 FPC接口封装
  - [ ] TP4056 封装
  - [ ] AMS1117 封装
  - [ ] Type-C 16P 封装
  - [ ] 电阻电容封装（0603/0805）
- [ ] 元件布局规划
  - [ ] 电源区域布局
  - [ ] 音频区域布局（注意麦克风远离噪声源）
  - [ ] 主控区域布局
  - [ ] 显示屏接口布局
- [ ] PCB布线
  - [ ] 电源走线（注意线宽）
  - [ ] I2S音频信号走线
  - [ ] SPI显示屏信号走线
  - [ ] GND铺铜
- [ ] 设计规则检查（DRC）
- [ ] 生成Gerber文件

### 5.3 PCB打样与焊接

- [ ] 选择PCB打样厂家（嘉立创 / 捷配等）
- [ ] 提交Gerber文件打样
- [ ] 采购贴片元件
- [ ] PCB焊接（手工/SMT）
- [ ] 焊接质量检查
- [ ] 上电测试

---

## 六、固件开发

### 5.1 WiFi通信模块

- [ ] 实现 WiFi 自动连接
- [ ] 实现 WiFi 配网功能（SmartConfig / Web配网）
- [ ] 实现与电脑服务端的 WebSocket 通信

### 5.2 音频处理固件

- [ ] 实现音频采集并通过网络发送到服务端
- [ ] 实现接收服务端音频并播放
- [ ] 实现音频流的缓冲处理

### 5.3 显示界面固件

- [ ] 实现待机界面（时间显示）
- [ ] 实现状态指示（录音中、播放中、思考中）
- [ ] 实现从服务端获取天气数据并显示

### 5.4 系统控制固件

- [ ] 实现设备状态机（待机/录音/播放/处理）
- [ ] 实现按键检测（如有）
- [ ] 实现低功耗模式（可选）

---

## 七、电脑服务端开发

### 6.1 项目初始化

- [ ] 创建 Python 项目结构
- [ ] 初始化 FastAPI 后端框架
- [ ] 配置依赖管理（requirements.txt）

### 6.2 通信服务

- [ ] 实现 WebSocket 服务端，接收硬件设备连接
- [ ] 实现音频数据接收接口
- [ ] 实现音频数据发送接口

### 6.3 语音识别（ASR）

- [ ] 集成 Whisper 本地语音识别
- [ ] 实现音频转文字功能
- [ ] 支持中英文识别

### 6.4 语音合成（TTS）

- [ ] 集成 Edge-TTS 语音合成
- [ ] 实现文字转音频功能
- [ ] 实现音频流返回给硬件设备

### 6.5 AI对话引擎

- [ ] 配置 LLM API（GPT-4 / Claude）
- [ ] 实现对话上下文管理
- [ ] 实现意图识别和响应生成

### 6.6 OpenClaw集成（电脑控制）

- [ ] 部署 OpenClaw 服务
- [ ] 封装 OpenClaw API 调用
- [ ] 实现文件/应用/系统控制功能

---

## 八、系统联调与测试

- [ ] 硬件设备与服务端通信测试
- [ ] 完整语音交互流程测试（说话→识别→AI回复→播放）
- [ ] 电脑控制功能测试
- [ ] 待机显示功能测试
- [ ] 稳定性测试

---

## MVP验收标准

1. **硬件正常工作**：ESP32-S3 + 麦克风 + 扬声器 + 屏幕 正常运行
2. **语音交互**：对设备说话，能识别并语音回复
3. **电脑控制**：能通过语音控制电脑（打开应用、文件操作等）
4. **待机显示**：屏幕显示时间/天气信息

---

## 引脚分配参考（ESP32-S3）

| 模块 | 引脚 | GPIO |
|------|------|------|
| INMP441 SCK | I2S_SCK | GPIO 14 |
| INMP441 WS | I2S_WS | GPIO 15 |
| INMP441 SD | I2S_SD | GPIO 32 |
| MAX98357A BCLK | I2S_BCLK | GPIO 26 |
| MAX98357A LRC | I2S_LRC | GPIO 25 |
| MAX98357A DIN | I2S_DOUT | GPIO 22 |
| ST7789 SCL | SPI_SCK | GPIO 18 |
| ST7789 SDA | SPI_MOSI | GPIO 23 |
| ST7789 DC | - | GPIO 2 |
| ST7789 CS | - | GPIO 5 |
| ST7789 RST | - | GPIO 4 |

*注：具体引脚需根据实际开发板调整*

---

*创建日期: 2026-02-05*
