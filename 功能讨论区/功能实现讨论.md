# 桌面AI助手 - 功能实现讨论

## 核心功能详细描述

### 1. 电脑文件管理与应用控制

- 文件操作：创建、删除、移动、重命名、搜索文件/文件夹
- 应用程序控制：打开、关闭、切换应用
- 系统操作：调节音量、亮度、截图、锁屏等

### 2. 手机App远程控制

- 发送文字/语音指令给AI
- 查看AI执行状态和反馈
- 远程触发预设任务
- 接收推送通知

### 3. 语音交互

- 语音唤醒词
- 语音指令识别
- 语音回复
- 中英文支持

### 4. 桌面摆件模式（待机状态）

- 时间显示
- 天气信息
- 日历/提醒事项
- 可自定义显示内容

### 5. AI智能待办（AI Todo）

- 语音添加任务：直接说"提醒我下午3点开会"自动创建待办
- 智能解析：自动识别时间、地点、优先级等信息
- 多种提醒方式：
  - 语音提醒：到时间语音播报任务内容
  - 震动提醒：设备震动引起注意
  - 灯光提醒：LED闪烁提示
  - 手机推送：同步推送到手机App
  - 屏幕弹窗：待机屏幕显示任务详情
- 重复提醒：未完成任务间隔重复提醒
- 任务追踪：语音确认"已完成"或"稍后提醒"
- 智能建议：根据日程自动建议最佳完成时间
- 任务分类：工作、生活、学习等分类管理
- 语音查询：问"今天还有什么任务"语音播报待办列表

### 6. AI人格系统

- 可选择不同性格的AI：
  - 温柔治愈型：说话温和、多鼓励
  - 傲娇型：嘴硬心软、偶尔吐槽
  - 毒舌型：犀利点评、激励式批评
  - 老友型：轻松幽默、像朋友聊天
  - 管家型：正式专业、高效简洁
  - 二次元型：动漫风格、可爱卖萌
- 自定义人格：用户自己设定人格特点
- 人格影响范围：语音语调、用词风格、回复方式
- 陪伴对话（闲聊模式）：
  - 不只是执行命令，可以聊天解闷
  - 主动关心：检测到长时间工作后主动问候
  - 情绪回应：根据用户语气调整回复方式
  - 话题记忆：记住聊过的话题，下次继续
  - 分享日常：主动分享有趣的事/冷知识
  - 倾听模式：用户想倾诉时安静倾听、适时回应

### 7. 智能场景模式

**专注模式：**

- 一键开启系统勿扰
- 自动关闭社交软件（微信、QQ、Slack等）
- 播放白噪音/专注音乐
- 屏蔽非紧急通知
- 专注计时显示
- 专注结束统计报告

**下班模式：**

- 一键关闭工作软件（IDE、Office、企业微信等）
- 自动整理当日文件到指定文件夹
- 生成今日工作总结
- 提醒明日待办事项
- 切换到休闲氛围（灯光、音乐）

**会议模式：**

- 自动开启系统静音
- 打开指定会议软件（腾讯会议、Zoom、Teams等）
- 会议录音功能：全程录制会议音频
- 实时转写：语音转文字记录
- 会议截图：定时或手动截图记录重点
- AI会议总结：自动生成会议纪要、待办事项、决策点
- 会议结束自动保存所有记录

### 8. 物理交互

- 摇一摇抽签：
  - 摇晃设备触发抽签功能
  - 今日运势抽签
  - 决策抽签（吃什么、做什么）
  - 随机名言/鸡汤
  - 幸运数字生成
- 拍一拍交互：
  - 拍一次：允许操作（确认执行）
  - 拍两次：拒绝操作（取消执行）
  - 拍三次：打断思考/操作（立即停止）
  - 也可语音控制："允许"/"拒绝"/"停止"
- 硬件按钮 - 纯聊天模式：
  - 按下按钮进入安全聊天模式
  - 不执行任何文件操作
  - 不控制任何应用程序
  - 纯粹的对话陪伴

### 9. AI日历

- 日程管理：
  - 语音添加日程："帮我添加明天下午3点和小明开会"
  - 语音修改日程："把明天的会议改到后天"
  - 语音删除日程："取消周五的聚餐"
  - 手机App同步编辑
- 智能提醒：
  - 每日早晨播报当日安排
  - 活动前提前提醒（可设置提前时间）
  - 多种提醒方式：语音、震动、屏幕显示
  - 重要日程重复提醒
- 智能建议：
  - AI分析日程冲突并提醒
  - 建议最佳会议时间
  - 根据日程自动调整场景模式
- 日历同步：
  - 同步系统日历（Apple/Google/Outlook）
  - 双向同步，修改自动更新

---

## 系统架构概览

```text
┌─────────────────────────────────────────────────────────────┐
│                        硬件层                                │
│  ESP32/树莓派 + 麦克风 + 扬声器 + 显示屏 + 传感器 + LED      │
└─────────────────────────┬───────────────────────────────────┘
                          │ WiFi/蓝牙
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                     电脑服务端                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  项目主程序 (Python + FastAPI)                       │   │
│  │  - AI对话引擎 (自研)                                 │   │
│  │  - 日历管理模块 (自研)                               │   │
│  │  - Todo待办模块 (自研)                               │   │
│  │  - 录音转写/会议总结 (自研)                          │   │
│  │  - 人格系统 (自研)                                   │   │
│  └──────────────────────┬──────────────────────────────┘   │
│                         │ API调用                           │
│                         ▼                                   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  OpenClaw (开源集成)                                 │   │
│  │  - 文件管理 (FileSystem Skills)                      │   │
│  │  - 应用控制 (Shell/Process Skills)                   │   │
│  │  - 系统操作 (System Skills)                          │   │
│  │  - 700+ AgentSkills 可扩展                           │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────┬───────────────────────────────────┘
                          │ HTTP/WebSocket
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                      手机App                                 │
│  Flutter/React Native + 推送服务                            │
└─────────────────────────────────────────────────────────────┘
```

### 模块分工说明

| 模块 | 实现方式 | 说明 |
| ---- | -------- | ---- |
| 电脑文件/应用控制 | OpenClaw集成 | 利用成熟开源方案，700+ Skills |
| AI日历 | 项目自研 | 定制化日程管理和提醒逻辑 |
| AI待办 | 项目自研 | 定制化任务管理和多端同步 |
| AI陪伴/人格 | 项目自研 | 定制化对话体验和情感交互 |
| 录音/会议总结 | 项目自研 | 定制化转写和AI总结流程 |
| 语音交互 | 项目自研 | 唤醒词、ASR、TTS整合 |
| 物理交互 | 项目自研 | 硬件传感器交互逻辑 |

---

## 核心功能实现方案

### 1. 电脑文件管理与应用控制（OpenClaw集成）

**功能回顾：**

- 文件操作：创建、删除、移动、重命名、搜索文件/文件夹
- 应用程序控制：打开、关闭、切换应用
- 系统操作：调节音量、亮度、截图、锁屏等

**实现方案：集成 OpenClaw**

OpenClaw 是一个开源AI代理平台，提供完善的电脑控制能力，我们将其集成到项目中。

**OpenClaw 简介：**

- 开源项目，GitHub 100k+ stars
- 提供 700+ AgentSkills 可直接使用
- 支持 macOS / Windows / Linux
- 可本地部署，数据完全可控
- 插件架构，易于扩展

**集成架构：**

```text
用户语音/文字指令
       ↓
项目主程序 (FastAPI)
       ↓ 解析意图
       ↓
  ┌────┴────┐
  │ 电脑控制 │ → OpenClaw API → 执行操作 → 返回结果
  └─────────┘
```

**OpenClaw Skills 对应表：**

| 功能 | OpenClaw Skill | 说明 |
| ---- | -------------- | ---- |
| 文件操作 | FileSystem Skills | 创建/删除/移动/搜索文件 |
| 打开应用 | Shell Skills | 执行系统命令启动应用 |
| 关闭应用 | Process Skills | 管理进程，终止应用 |
| 音量控制 | System Skills | 系统级控制 |
| 亮度控制 | System Skills | 屏幕亮度调节 |
| 截图 | Screenshot Skills | 屏幕截图 |
| 锁屏 | System Skills | 系统锁定 |

**集成方式：**

```python
# 项目主程序调用 OpenClaw API 示例
from openclaw import ClawClient

claw = ClawClient(host="localhost", port=8080)

# 执行文件操作
result = claw.execute("创建文件夹 ~/Desktop/新项目")

# 执行应用控制
result = claw.execute("打开 Visual Studio Code")

# 执行系统操作
result = claw.execute("把音量调到50%")
```

**安全措施：**

- Docker 沙箱运行 OpenClaw
- 敏感操作需用户确认（拍一拍/语音确认）
- 操作日志记录
- 纯聊天模式下禁用 OpenClaw 调用

---

### 2. 手机App远程控制

**功能回顾：**

- 发送文字/语音指令给AI
- 查看AI执行状态和反馈
- 远程触发预设任务
- 接收推送通知

**实现方案：**

| 组件 | 技术选型 |
| ---- | -------- |
| App框架 | Flutter (跨平台) |
| 通信协议 | WebSocket (实时) + REST API |
| 推送服务 | Firebase Cloud Messaging |
| 语音录制 | 系统原生API |

**通信流程：**

```text
手机App → WebSocket → 电脑服务端 → 硬件设备
                ↓
           执行结果返回
                ↓
           推送通知到App
```

---

### 3. 语音交互

**功能回顾：**

- 语音唤醒词
- 语音指令识别
- 语音回复
- 中英文支持

**实现方案：**

| 功能 | 技术选型 |
| ---- | -------- |
| 语音唤醒 | Porcupine (本地) / Snowboy |
| 语音识别(ASR) | Whisper (本地) / 讯飞API |
| 语音合成(TTS) | Edge-TTS / pyttsx3 |
| 中英文支持 | Whisper多语言模型 |

**处理流程：**

```text
麦克风 → 唤醒词检测 → 录音 → ASR转文字 → AI理解 → 执行 → TTS回复
```

---

### 4. 桌面摆件模式（待机状态）

**功能回顾：**

- 时间显示
- 天气信息
- 日历/提醒事项
- 可自定义显示内容

**实现方案：**

| 功能 | 技术选型 |
| ---- | -------- |
| 显示屏 | OLED (SSD1306) / LCD (ILI9341) |
| 时间同步 | NTP服务器 |
| 天气数据 | 和风天气API / OpenWeatherMap |
| UI框架 | LVGL (嵌入式GUI) |

---

### 5. AI智能待办（AI Todo）

**功能回顾：**

- 语音添加/修改/删除任务
- 智能解析时间、地点、优先级
- 多种提醒方式：语音、震动、灯光、推送、屏幕
- 语音查询待办列表

**实现方案：**

| 组件 | 技术选型 |
| ---- | -------- |
| 数据存储 | SQLite数据库 |
| 时间解析 | dateparser库 / LLM解析 |
| 定时任务 | APScheduler |
| 提醒触发 | 多线程监控 + 事件驱动 |

**数据结构：**

```text
Todo {
    id, title, description,
    due_time, remind_time,
    priority, category,
    status, created_at
}
```

---

### 6. AI人格系统

**功能回顾：**

- 多种预设人格（温柔/傲娇/毒舌/老友/管家/二次元）
- 自定义人格
- 陪伴对话（闲聊模式）

**实现方案：**

| 组件 | 技术选型 |
| ---- | -------- |
| AI模型 | GPT-4 API / Claude API / 本地LLM |
| 人格实现 | System Prompt定制 |
| 对话记忆 | 向量数据库 (ChromaDB) |
| 情绪检测 | 语音语调分析 + 文本情感分析 |

**人格Prompt示例：**

```text
温柔治愈型：你是一个温柔体贴的助手，说话轻柔，经常鼓励用户...
傲娇型：你是一个傲娇的助手，嘴上说着"才不是为了你"，但总是认真帮忙...
```

---

### 7. 智能场景模式

**功能回顾：**

- 专注模式：勿扰、关闭社交软件、白噪音
- 下班模式：关闭工作软件、整理文件、生成总结
- 会议模式：静音、录音、转写、AI总结

**实现方案：**

| 功能 | 技术选型 |
| ---- | -------- |
| 应用控制 | 同功能1的系统控制 |
| 白噪音 | pygame音频播放 |
| 文件整理 | Python脚本 + 规则引擎 |
| 会议录音 | pyaudio录制 |
| 实时转写 | Whisper流式识别 |
| AI总结 | LLM生成会议纪要 |

**场景配置文件：**

```text
专注模式 {
    close_apps: ["微信", "QQ", "Slack"],
    enable_dnd: true,
    play_sound: "white_noise.mp3",
    duration: 25min (番茄钟)
}
```

---

### 8. 物理交互

**功能回顾：**

- 摇一摇抽签
- 拍一拍交互（1次允许/2次拒绝/3次打断）
- 硬件按钮（纯聊天模式）

**实现方案：**

| 功能 | 技术选型 |
| ---- | -------- |
| 加速度检测 | MPU6050传感器 |
| 震动检测 | 压电传感器 / 加速度计 |
| 按钮输入 | GPIO中断 |
| 震动马达 | 小型振动电机 |

**交互检测逻辑：**

```text
摇一摇：加速度变化 > 阈值，持续0.5秒
拍一拍：检测短促冲击，计数间隔<0.5秒
按钮：GPIO下降沿中断触发
```

---

### 9. AI日历

**功能回顾：**

- 语音添加/修改/删除日程
- 智能提醒（早晨播报、活动前提醒）
- 日历同步（Apple/Google/Outlook）

**实现方案：**

| 组件 | 技术选型 |
| ---- | -------- |
| 数据存储 | SQLite + iCal格式 |
| 日历同步 | CalDAV协议 / Google Calendar API |
| 时间解析 | dateparser + LLM |
| 冲突检测 | 时间区间重叠算法 |

**同步流程：**

```text
本地日历 ←→ CalDAV服务器 ←→ 系统日历App
```

---

## 硬件清单

| 组件 | 型号建议 | 用途 |
| ---- | -------- | ---- |
| 主控板 | ESP32-S3 / 树莓派4B | 运行固件/系统 |
| 麦克风 | INMP441 | 语音采集 |
| 扬声器 | MAX98357 + 3W喇叭 | 语音输出 |
| 显示屏 | 2.4寸 ILI9341 LCD | 信息显示 |
| 加速度计 | MPU6050 | 摇一摇/拍一拍检测 |
| 震动马达 | 1020扁平马达 | 震动提醒 |
| LED灯 | WS2812B灯珠 | 状态指示 |
| 按钮 | 轻触开关 | 模式切换 |

---

## 技术栈总结

| 层级 | 技术 | 说明 |
| ---- | ---- | ---- |
| 硬件固件 | MicroPython / Arduino | 硬件控制 |
| 电脑后端 | Python + FastAPI | 项目主程序 |
| 电脑控制 | OpenClaw | 文件/应用/系统控制 |
| AI模型 | Whisper + GPT/Claude API | 语音识别 + 对话 |
| 数据库 | SQLite | 日历/待办/对话记录 |
| 手机App | Flutter | 跨平台移动端 |
| 通信 | WebSocket + MQTT | 实时通信 |

---

## 开发优先级建议

1. **第一阶段（MVP）**：
   - 集成 OpenClaw 实现基础电脑控制
   - 语音交互（唤醒词 + ASR + TTS）
   - 基础对话能力

2. **第二阶段**：
   - AI待办模块（自研）
   - AI日历模块（自研）
   - 待机显示界面

3. **第三阶段**：
   - AI人格系统（自研）
   - 录音转写/会议总结（自研）
   - 智能场景模式

4. **第四阶段**：
   - 手机App开发
   - 物理交互（摇一摇/拍一拍）
   - 多端同步

---

创建日期: 2026-02-04
